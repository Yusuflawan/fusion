<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- begin::GXON Meta Basic -->
    <meta charset="utf-8" />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
      rel="stylesheet"
    />

    <!-- Material Symbols Rounded (optional) -->
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded"
      rel="stylesheet"
    />

    <!-- Material Symbols Sharp (optional) -->
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp"
      rel="stylesheet"
    />
    
    <title>Fussion</title>
    <!-- end::GXON Website Page Title -->

    <!-- begin::GXON Mobile Specific -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/png" href="assets/images/logo.jpeg" />

    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="assets/images/logo.jpeg"
    />
    <!-- end::GXON Favicon Tags -->

    <!-- begin::GXON Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap"
      rel="stylesheet"
    />
    <!-- end::GXON Google Fonts -->

    <!-- begin::GXON Required Stylesheet -->
    <link rel="stylesheet" href="assets/libs/flaticon/css/all/all.css" />
    <link rel="stylesheet" href="assets/libs/lucide/lucide.css" />
    <link rel="stylesheet" href="assets/libs/fontawesome/css/all.min.css" />
    <link rel="stylesheet" href="assets/libs/simplebar/simplebar.css" />
    <link rel="stylesheet" href="assets/libs/node-waves/waves.css" />
    <link
      rel="stylesheet"
      href="assets/libs/bootstrap-select/css/bootstrap-select.min.css"
    />
    <!-- end::GXON Required Stylesheet -->

    <!-- begin::GXON CSS Stylesheet -->
    <link rel="stylesheet" href="assets/libs/datatables/datatables.min.css" />
    <link rel="stylesheet" href="assets/libs/flatpickr/flatpickr.min.css" />
    <link rel="stylesheet" href="assets/css/styles.css" />
    <link rel="stylesheet" href="assets/css/style1.css" />
    <link rel="stylesheet" href="assets/css/chart.css" />
    <!-- end::GXON CSS Stylesheet -->
     <!-- DataTables CSS -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.bootstrap5.min.css">


    <!-- begin::GXON Googletagmanager -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-XWVQM68HHQ"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-XWVQM68HHQ", {
        cookie_flags: "SameSite=None;Secure",
        send_page_view: true,
      });
    </script>
    <!-- end::GXON Googletagmanager -->
  </head>

  <body>
    <div class="page-layout">
      <!-- begin::GXON Page Header -->
      <header class="app-header">
        <div class="app-header-inner" id="header"></div>
      </header>
      <!-- end::GXON Page Header -->

      <!-- begin::GXON Sidebar Menu -->
      <div id="sidebsr" class="app-menubar"></div>
      <!-- end::GXON Sidebar Menu -->

      <!-- begin::GXON Sidebar right -->
      <!-- <div class="app-sidebar-end">
        <ul class="sidebar-list">
          <li>
            <a href="javascript:void(0);">
              <div
                class="avatar avatar-sm bg-warning shadow-sharp-warning rounded-circle text-white mx-auto mb-2"
              >
                <i class="fi fi-rr-to-do"></i>
              </div>
              <span class="text-dark">Tax</span>
            </a>
          </li>
          <li>
            <a href="javascript:void(0);">
              <div
                class="avatar avatar-sm bg-secondary shadow-sharp-secondary rounded-circle text-white mx-auto mb-2"
              >
                <i class="fi fi-rr-interrogation"></i>
              </div>
              <span class="text-dark">Help</span>
            </a>
          </li>
          <li>
            <a href="javascript:void(0);">
              <div
                class="avatar avatar-sm bg-info shadow-sharp-info rounded-circle text-white mx-auto mb-2"
              >
                <i class="fi fi-rr-calendar"></i>
              </div>
              <span class="text-dark">date</span>
            </a>
          </li>
          <li>
            <a href="javascript:void(0);">
              <div
                class="avatar avatar-sm bg-gray shadow-sharp-gray rounded-circle text-white mx-auto mb-2"
              >
                <i class="fi fi-rr-settings"></i>
              </div>
              <span class="text-dark">Settings</span>
            </a>
          </li>
        </ul>
      </div> -->
      <!-- end::GXON Sidebar right -->

      <main class="app-wrapper">
        <div class="container-fluid mb-5">
          <div
            class="app-page-head d-flex flex-wrap gap-3 align-items-center justify-content-between"
          >
            <div class="clearfix">
              <h1 class="app-page-title">Ingestion Monitor</h1>
              <nav aria-label="breadcrumb">
                <ol class="breadcrumb mb-0">
                  <li class="breadcrumb-item">
                    <a href="index.html">Dashboard</a>
                  </li>
                  <li class="breadcrumb-item active" aria-current="page">
                    Ingestion Monitor
                  </li>
                </ol>
              </nav>
            </div>
            <!-- Time Range Select -->
            <div class="mb-3">
              <select class="form-select" id="timeRange">
                <option value="24h">Last 24 Hours</option>
                <option value="1h">Last Hour</option>
                <option value="7d">Last 7 Days</option>
                <option value="30d">Last 30 Days</option>
              </select>
            </div>
          </div>
        </div>
        <div class="container">
          <div class="row">
            <div class="col-xxl-12">
              <div class="row">
                <div class="col-xxl-2 col-lg-4 col-sm-6">
                  <div
                    class="card card-action action-border-secondary p-1 position-relative"
                  >
                    <div
                      class="card-body d-flex gap-3 align-items-center p-4"
                      style="position: relative"
                    >
                      <div class="clearfix">
                        <div class="mb-1 text-dark fw-bold">
                          Total <br />Batches
                        </div>
                        <h3 class="mb-0 fw-bold mt-3" id="totalBatches"></h3>
                        <small>Submitted today</small>
                      </div>
                      <div
                        class="clearfix pe-2 text-secondary"
                        style="position: absolute; top: 10%; right: 0%"
                      >
                        <i class="fi fi-rr-boxes"></i>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xxl-2 col-lg-4 col-sm-6">
                  <div
                    class="card card-action action-border-secondary p-1 position-relative"
                  >
                    <div
                      class="card-body d-flex gap-3 align-items-center p-4"
                      style="position: relative"
                    >
                      <div class="clearfix">
                        <div class="mb-1 text-dark fw-bold">Successful</div>
                        <h3 class="mb-0 fw-bold mt-3 text-success" id="successful"></h3>
                        <small>Processed successfull</small>
                      </div>
                      <div
                        class="clearfix pe-2 text-success"
                        style="position: absolute; top: 10%; right: 0%"
                      >
                        <i
                          class="fi fi-rr-check rounded-pill"
                          style="border: 1px green solid"
                        ></i>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xxl-2 col-lg-4 col-sm-6">
                  <div
                    class="card card-action action-border-secondary p-1 position-relative"
                  >
                    <div
                      class="card-body d-flex gap-3 align-items-center p-4"
                      style="position: relative"
                    >
                      <div class="clearfix">
                        <div class="mb-1 text-dark fw-bold">Failed</div>
                        <h3 class="mb-0 fw-bold text-danger mt-3" id="failed"></h3>
                        <small>Processing failed</small>
                      </div>
                      <div
                        class="clearfix pe-2 text-danger"
                        style="position: absolute; top: 10%; right: 0%"
                      >
                        <i class="fi fi-rr-cross-circle"></i>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xxl-2 col-lg-4 col-sm-6">
                  <div
                    class="card card-action action-border-secondary p-1 position-relative"
                  >
                    <div
                      class="card-body d-flex gap-3 align-items-center p-4"
                      style="position: relative"
                    >
                      <div class="clearfix">
                        <div class="mb-1 text-dark fw-bold">Partial</div>
                        <h3 class="mb-0 fw-bold text-dark mt-3" id="partial"></h3>
                        <small>Partially processed</small>
                      </div>
                      <div
                        class="clearfix pe-2"
                        style="
                          position: absolute;
                          top: 10%;
                          right: 0%;
                          color: blueviolet;
                        "
                      >
                        <i class="fi fi-rr-circle-half-stroke"></i>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xxl-2 col-lg-4 col-sm-6">
                  <div
                    class="card card-action action-border-secondary p-1 position-relative"
                  >
                    <div
                      class="card-body d-flex gap-3 align-items-center p-4"
                      style="position: relative"
                    >
                      <div class="clearfix">
                        <div class="mb-1 text-dark fw-bold">
                          Total<br />
                          Records
                        </div>
                        <h3 class="mb-0 fw-bold text-dark mt-3">145,234</h3>
                        <small>Records submitted</small>
                      </div>
                      <div
                        class="clearfix pe-2 text-secondary"
                        style="position: absolute; top: 10%; right: 0%"
                      >
                        <i class="fi fi-rr-database"></i>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xxl-2 col-lg-4 col-sm-6">
                  <div
                    class="card card-action action-border-secondary p-1 position-relative"
                  >
                    <div
                      class="card-body d-flex gap-3 align-items-center p-4"
                      style="position: relative"
                    >
                      <div class="clearfix">
                        <div class="mb-1 text-dark fw-bold">Avg Time</div>
                        <h3 class="mb-0 fw-bold text-dark mt-3">234ms</h3>
                        <small>Processing time</small>
                      </div>
                      <div
                        class="clearfix pe-2 text-success"
                        style="position: absolute; top: 10%; right: 0%"
                      >
                        <i class="fi fi-rr-stopwatch"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!--
           
          -->
            <div class="col-lg-12">
              <div class="container my-4">
                <div class="card card-customs shadow-sm">
                  <h5 class="mb-0">Batch Submission History</h5>
                  <small class="text-muted"
                    >Recent data batch submissions and their status</small
                  >
                  <div class="table-responsive mt-3">
                    <table class="table align-middle">
                      <thead>
                        <tr>
                          <th>Batch ID</th>
                          <th>Timestamp</th>
                          <th>Record Count</th>
                          <th>Processing Time</th>
                          <th>Error Count</th>
                          <th>Status</th>
                          <th>Actions</th>
                        </tr>
                      </thead>
                      <tbody id="batchTableBody"></tbody>
                    </table>
                  </div>
                </div>
              </div>
              <div class="container my-4">
                <div class="card card-customse shadow-sm">
                  <h5 class="mb-0">Recent Errors</h5>
                  <small class="text-muted"
                    >Details of recent submission errors</small
                  >

                  <!-- Error Item 1 -->
                  <div
                    class="error-box d-flex justify-content-between align-items-start mt-3"
                  >
                    <div>
                      <div class="error-title">Batch BTH-20240120-004</div>
                      <div class="error-message">
                        Authentication failed - invalid API key
                      </div>
                      <div class="error-meta">
                        Records: 2,674 &nbsp;&nbsp; Errors: 2674
                      </div>
                    </div>
                    <div class="error-date">2024-01-20 15:00:08</div>
                  </div>

                  <!-- Error Item 2 -->
                  <div
                    class="error-box d-flex justify-content-between align-items-start"
                  >
                    <div>
                      <div class="error-title">Batch BTH-20240120-005</div>
                      <div class="error-message">
                        Some records failed validation
                      </div>
                      <div class="error-meta">
                        Records: 2,156 &nbsp;&nbsp; Errors: 23
                      </div>
                    </div>
                    <div class="error-date">2024-01-20 14:45:33</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>

      <!-- begin::GXON Footer -->

      <!-- end::GXON Footer -->
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Mobile filter toggle functionality
        const mobileToggle = document.getElementById("mobileFilterToggle");
        const filterControls = document.getElementById("filterControls");
        const toggleIcon = document.getElementById("toggleIcon");

        mobileToggle?.addEventListener("click", function () {
          if (window.innerWidth <= 768) {
            filterControls.classList.toggle("show");
            toggleIcon.classList.toggle("fa-chevron-down");
            toggleIcon.classList.toggle("fa-chevron-up");
          }
        });

        // Handle window resize
        window.addEventListener("resize", function () {
          if (window.innerWidth > 768) {
            filterControls.classList.remove("show");
            filterControls.classList.add("filter-controls");
            toggleIcon.classList.remove("fa-chevron-up");
            toggleIcon.classList.add("fa-chevron-down");
          } else {
            filterControls.classList.add("filter-controls");
          }
        });

        // Search functionality
        const searchInput = document.getElementById("searchInput");
        searchInput?.addEventListener("input", function () {
          const query = this.value;
          console.log("Searching for:", query);
          // Add your search logic here
        });

        // Dropdown item selection
        document.querySelectorAll(".dropdown-item").forEach((item) => {
          item.addEventListener("click", function (e) {
            e.preventDefault();

            const dropdown = this.closest(".dropdown");
            const button = dropdown.querySelector(".dropdown-toggle");
            const value = this.getAttribute("data-value");
            const text = this.textContent.trim();

            // Update button text
            const buttonText = button.innerHTML.split("<")[0].trim();
            button.innerHTML =
              text + ' <span class="dropdown-toggle-split"></span>';

            // Update active state
            dropdown
              .querySelectorAll(".dropdown-item")
              .forEach((i) => i.classList.remove("active"));
            this.classList.add("active");

            console.log(`${buttonText} changed to:`, value);
          });
        });

        // Export functionality
        document
          .getElementById("exportBtn")
          ?.addEventListener("click", function () {
            const btn = this;
            const originalHTML = btn.innerHTML;

            // Loading state
            btn.innerHTML =
              '<i class="fas fa-spinner fa-spin"></i><span>Exporting...</span>';
            btn.disabled = true;

            // Simulate export process
            setTimeout(() => {
              btn.innerHTML =
                '<i class="fas fa-check"></i><span>Exported!</span>';
              setTimeout(() => {
                btn.innerHTML = originalHTML;
                btn.disabled = false;
              }, 1500);
            }, 2000);
          });

        // Date change handler
        document
          .getElementById("dateInput")
          ?.addEventListener("change", function () {
            console.log("Date changed to:", this.value);
          });
      });
    </script>
    <!-- begin::GXON Page Scripts -->
     <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="assets/js/header.js"></script>
    <script src="assets/libs/global/global.min.js"></script>
    <script src="assets/libs/chartjs/chart.js"></script>
    <script src="assets/libs/apexcharts/apexcharts.min.js"></script>
    <script src="assets/libs/datatables/datatables.min.js"></script>
    <script src="assets/libs/flatpickr/flatpickr.min.js"></script>
    <script src="assets/js/flatpickr.js"></script>
    <script src="assets/js/dashboard.js"></script>
    <script src="assets/js/appSettings.js"></script>
    <script src="assets/js/main.js"></script>
    <!-- DataTables JS -->
<script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.bootstrap5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.print.min.js"></script>
    <script src="assets/js/myjs/monitor.js"></script>
    <!-- end::GXON Page Scripts -->
    <script>
      // document.addEventListener("DOMContentLoaded", async () => {
      //   const totalBatches = document.getElementById("totalBatches");
      //   const user = JSON.parse(localStorage.getItem("user"));
      //   const successful = document.getElementById("successful");
      //   const failed = document.getElementById("failed");
      //   const partial = document.getElementById("partial");
      //   const tbody = document.getElementById("batchTableBody");
      //   const count_id = user.user_id;
        
      //   try {
      //     const response = await fetch(
      //       `https://arafatfootballacademy.com/fusion/backend/provider/${count_id}/batches`
      //     );
      //     const result = await response.json();
          
      //     totalBatches.textContent = result?.data.length || "0";

      //     const totalSuccess = result?.data.filter(
      //       (batch) => batch.status === "success"
      //     ).length;

      //     const totalFailed = result?.data.filter(
      //       (batch) => batch.status === "failed"
      //     ).length;

      //     const totalPartial = result?.data.filter(
      //       (batch) => batch.status === "partial"
      //     ).length;

      //     successful.textContent = totalSuccess || "0";
      //     failed.textContent = totalFailed || "0";
      //     partial.textContent = totalPartial || "0";
          
      //     if (result.status === "success" && Array.isArray(result.data)) {
      //       if (result.data.length === 0) {
      //         tbody.innerHTML = `<tr><td colspan="7" class="text-center text-muted">No batch records found</td></tr>`;
      //         return;
      //       }

      //       // Update total batches count
            
      //       tbody.innerHTML = "";

      //       result.data.forEach((batch) => {
      //         let errorClass =
      //           batch.error_count == 0 ? "error-zero" : "error-high";
      //           let statusClass = "status-partial";
      //           if (batch.status === "success") statusClass = "status-success";
      //           if (batch.status === "failed") statusClass = "status-failed";

      //           let retryHtml =
      //           batch.status === "failed"
      //           ? `<span class="retry-link">Retry</span>`
      //           : "";
                
      //           tbody.innerHTML += `
      //           <tr>
      //             <td>${batch.batch_id}</td>
      //             <td>${batch.timestamp}</td>
      //             <td>${batch.record_count.toLocaleString()}</td>
      //             <td>${batch.processing_time}ms</td>
      //             <td class="${errorClass}">${batch.error_count}</td>
      //       <td><span class="status-badge ${statusClass}">${
      //         batch.status
      //         }</span></td>
      //         <td>
      //           <a href="#" class="action-link text-primary">View Details</a>
      //           ${retryHtml}
      //           </td>
      //           </tr>
      //           `;
      //         });
      //       } else {
      //         tbody.innerHTML = `<tr><td colspan="7" class="text-center text-muted">Failed to load data</td></tr>`;
      //       }
      //   } catch (error) {
      //     console.error("Error fetching batches:", error);
      //     tbody.innerHTML = `<tr><td colspan="7" class="text-center text-danger">Error loading data</td></tr>`;
      //   }
      // });
    </script>
  </body>
</html>
